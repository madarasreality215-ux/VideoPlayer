<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MediaTracker Pro â€” Local Only (IndexedDB + LocalStorage)</title>
<style>
:root{--bg:#0b1220;--card:#0f1724;--card2:#141b2b;--txt:#e6eef9;--muted:rgba(230,238,249,.7);--acc:#7c3aed;--accH:#6d28d9;--thin:rgba(255,255,255,.15);--secBG:rgba(255,255,255,.03);--secBD:rgba(255,255,255,.08)}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--txt);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica Neue,Arial}
header{position:sticky;top:0;z-index:40;display:flex;justify-content:space-between;align-items:center;background:var(--card);padding:12px 16px;border-bottom:1px solid var(--thin)}
.title{margin:0;font-weight:800;font-size:18px;letter-spacing:.2px}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:6px;height:42px;padding:10px 16px;border-radius:10px;border:1px solid transparent;font-weight:700;color:#fff;background:var(--acc);cursor:pointer;text-decoration:none;transition:background .15s,transform .08s}
.btn:hover{background:var(--accH);transform:translateY(-1px)}
.btn-ghost{background:var(--card);border-color:var(--thin);color:var(--txt)}
.container{display:grid;grid-template-columns:320px 1fr;gap:16px;padding:16px}
@media(max-width:900px){.container{grid-template-columns:1fr}}
.sidebar,.main{background:var(--card);padding:12px;border-radius:12px}
.section{background:var(--secBG);border:1px solid var(--secBD);border-radius:12px;padding:12px;margin-bottom:14px}
.section h3{margin:0 0 8px;font-size:15px;color:var(--acc);font-weight:800}
.row{display:flex;gap:10px;align-items:center;margin-bottom:10px}
.row:last-child{margin-bottom:0}
input{width:100%;padding:10px 12px;background:var(--card2);border:1px solid rgba(255,255,255,.12);border-radius:10px;color:var(--txt);font-size:14px}
input::placeholder{color:rgba(230,238,249,.6)}
.status{display:flex;align-items:center;gap:8px;font-size:13px;color:var(--muted)}
.dot{width:8px;height:8px;border-radius:50%;background:#22c55e;box-shadow:0 0 0 0 rgba(34,197,94,.7);animation:pulse 1.6s infinite}
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(34,197,94,.7)}70%{box-shadow:0 0 0 12px rgba(34,197,94,0)}100%{box-shadow:0 0 0 0 rgba(34,197,94,0)}}
.empty{font-size:13px;color:var(--muted);text-align:center}
/* Folders */
.folders{display:flex;flex-direction:column;gap:6px;max-height:40vh;overflow:auto;padding-right:4px}
.frow{position:relative;display:flex;align-items:center;gap:8px;padding:8px;border-radius:8px;background:rgba(255,255,255,.02)}
.frow:hover{background:rgba(255,255,255,.05)}
.fchev{width:16px;text-align:center;opacity:.8;transition:transform .15s}
.frow.expanded>.fchev{transform:rotate(90deg)}
.fname{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.fctrl{position:absolute;right:8px;display:flex;gap:6px;opacity:0;transition:opacity .15s}
.frow:hover .fctrl{opacity:1}
.fctrl button{background:transparent;border:1px solid rgba(255,255,255,.15);color:var(--txt);border-radius:8px;height:28px;padding:0 8px;cursor:pointer}
.children{overflow:hidden;max-height:0;opacity:.0;transition:max-height .23s ease,opacity .23s ease}
.children.show{opacity:1}
/* Video list */
.videoList{display:flex;flex-direction:column;gap:8px}
.vitem{display:flex;gap:10px;align-items:center;padding:8px;border-radius:12px;background:rgba(255,255,255,.02);cursor:grab;transition:background .15s}
.vitem:hover{background:rgba(255,255,255,.05)}
.vitem[draggable=true]{user-select:none}
.thumb{width:120px;height:72px;background:#000;border-radius:10px;overflow:hidden;flex-shrink:0}
.thumb img,.thumb video{width:100%;height:100%;object-fit:cover}
.meta{flex:1;min-width:0}
.meta h4{margin:0;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.meta p{margin:4px 0 0;font-size:12px;color:var(--muted)}
.upload-progress{height:5px;background:rgba(255,255,255,.08);border-radius:999px;overflow:hidden;margin-top:6px}
.upload-progress .bar{width:0%;height:100%;background:var(--acc);transition:width .2s ease}
/* Viewer */
.viewer-full{display:none;position:fixed;inset:0;background:rgba(0,0,0,.96);opacity:0;transition:opacity .25s ease;pointer-events:none;z-index:1000}
.viewer-full.show{display:block;opacity:1;pointer-events:auto}
.viewer-wrap{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:24px}
.viewer-video{max-width:100%;max-height:100%;border-radius:14px;box-shadow:0 0 60px rgba(0,0,0,.6)}
.viewer-toolbar{position:absolute;top:0;left:0;right:0;height:56px;display:flex;align-items:center;padding:0 16px;background:linear-gradient(to bottom, rgba(0,0,0,.65), rgba(0,0,0,0));color:#e6eef9;}
.viewer-title{font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.retry-wrap{position:absolute;inset:auto auto 24px 24px;display:none}
.retry-btn{height:36px;padding:0 12px;border-radius:10px;border:1px solid rgba(255,255,255,.25);background:rgba(255,255,255,.08);color:#fff;cursor:pointer}
.trashOv{position:absolute;left:16px;right:16px;bottom:24px;padding:14px;background:rgba(239,68,68,.08);border:2px dashed rgba(239,68,68,.6);border-radius:12px;text-align:center;color:#ef4444;font-weight:700;opacity:0;pointer-events:none;transition:opacity .25s,transform .25s}
.trashOv.active{opacity:1;transform:translateY(-6px);pointer-events:auto}
.trashOv.drag-over{background:rgba(239,68,68,.14)}
</style>
</head>
<body>
<header>
  <h1 class="title">ğŸ“± MediaTracker Pro</h1>
  <a href="stats.html" class="btn btn-ghost">ğŸ“Š Stats</a>
</header>

<div class="container">
  <aside class="sidebar" style="position:relative">
    <div class="section"><div class="status"><span class="dot"></span><span>Local mode: IndexedDB + LocalStorage</span></div></div>

    <div class="section">
      <h3>ğŸ“ Folder Management</h3>
      <div class="row"><input id="newFolderName" placeholder="New folder name"></div>
      <button id="addFolderBtn" class="btn" style="width:100%">ğŸ“ Add Folder</button>
    </div>

    <div class="section">
      <h3>ğŸ“‚ Your Folders</h3>
      <div id="folders" class="folders"><div class="empty" id="noFolders">No folders yet. Create one above!</div></div>
    </div>

    <div class="section">
      <h3>â• Add Media</h3>
      <div class="row">
        <button id="addVideoBtn" class="btn" style="flex:1">ğŸ¥ Add Videos</button>
        <button id="addPhotoBtn" class="btn" style="flex:1;background:#10b981">ğŸ“· Add Photos</button>
      </div>
      <div class="empty" style="margin-top:6px">Supports MP4, WebM, MOV, JPG, PNG, GIF</div>
    </div>

    <div class="section">
      <h3>ğŸ¦ Twitter/X Downloader</h3>
      <div class="row"><input id="twUrl" placeholder="Paste Twitter/X URL here"></div>
      <div class="row"><button id="twFetch" class="btn" style="width:100%">Fetch Twitter Media</button></div>
    </div>

    <div id="tweetPreviewSection" class="section" style="display:none;">
      <h3>ğŸï¸ Tweet Media Preview</h3>
      <div class="vitem" style="cursor:default;">
        <div class="thumb"><video id="tweetPreviewVideo" muted autoplay loop playsinline></video></div>
        <div class="meta"><h4 id="tweetPreviewTitle">Previewing Tweet Mediaâ€¦</h4><p>Detected video â€¢ Ready to save locally</p></div>
      </div>
      <button id="tweetDownloadBtn" class="btn" style="width:100%;margin-top:10px;">â¬‡ï¸ Add to VideoList</button>
    </div>

    <div id="trashBinOverlay" class="trashOv">ğŸ—‘ï¸ Drop to Delete Media</div>
  </aside>

  <main class="main">
    <div class="section">
      <div class="row">
        <input type="search" id="searchInput" placeholder="ğŸ” Search media...">
        <button id="sortBtn" class="btn">ğŸ“… Sort: Newest</button>
      </div>
    </div>
    <div id="videoList" class="videoList"></div>
  </main>
</div>

<!-- Viewer -->
<div id="viewer" class="viewer-full">
  <div class="viewer-wrap">
    <div class="viewer-toolbar">
      <button class="viewer-back" id="viewerBack">â† Back</button>
      <div class="viewer-title" id="viewerTitle"></div>
    </div>
    <video id="viewerVideo" class="viewer-video" controls playsinline crossorigin="anonymous"></video>
    <div class="retry-wrap" id="retryWrap"><button class="retry-btn" id="retryBtn">â†» Retry Play</button></div>
  </div>
</div>

<script>
// Core logic stays identical to previous build except viewerDownload + close removed
// ... (keep same JavaScript from previous file but remove any viewerDl and closePopup references)
</script>
</body>
</html>
